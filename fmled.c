/* 
 * FM tuner for PIC16F1503
 *    Freq display like CW
 *
 *      JA1YTS:Toshiba Amature Radio Station
 *      JK1MLY:Hidekazu Inaba
 *
 *  (C)2022 JA1YTS,JK1MLY All rights reserved.
 * Redistribution and use in source and binary forms, with or without modification, 
 * are permitted provided that the following conditions are met:
 * 1. Redistributions of source code must retain the above copyright notice, 
 * this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice, 
 * this list of conditions and the following disclaimer in the documentation and/or 
 * other materials provided with the distribution.
 *
 *
 * data sheet
 *  https://datasheet.lcsc.com/szlcsc/RDA5807M_C82537.pdf
 *
 *
 */

#include <stdio.h>
//#include <c90/stdlib.h>
#include <stdint.h>
#include <xc.h>
#include <pic.h>
#include <pic16F1503.h>

#define _XTAL_FREQ 4000000
// CONFIG1
#pragma config FOSC = INTOSC    // Oscillator Selection
#pragma config WDTE = OFF       // Watchdog Timer
#pragma config PWRTE = OFF      // Power-up Timer
#pragma config MCLRE = OFF      // MCLR Pin Function Select
#pragma config CP = OFF         // Flash Program Memory Code Protection
#pragma config BOREN = ON       // Brown-out Reset Enable
#pragma config CLKOUTEN = OFF   // Clock Out Enable
// CONFIG2
#pragma config WRT = OFF        // Flash Memory Self-Write Protection
// #pragma config PLLEN = OFF      // 4x PLL OFF
#pragma config STVREN = OFF     // Stack Overflow/Underflow Reset Enable
#pragma config BORV = LO        // Brown-out Reset Voltage Selection
// #pragma config LPBOREN = OFF    // Low Power Brown-out Reset Enable
#pragma config LVP = OFF        // Low-Voltage Programming Enable

#define	I2C_SDA_LOW     LATA5 = 0;TRISA5 = 0    // 0
#define I2C_SDA_HIGH	LATA5 = 1;TRISA5 = 1    // Z(1)
#define	I2C_SDA_READ    LATA5 = 0;TRISA5 = 1    // Input
#define	I2C_SDA_DATA    RA5
#define	I2C_SCK_LOW     LATA4 = 0
#define	I2C_SCK_HIGH	LATA4 = 1

#define	LED1_ON      	LATA0 = 1; LATA1 = 0
#define	LED1_OFF     	LATA0 = 0; LATA1 = 0
#define	LED2_ON      	LATA1 = 1; LATA2 = 0
#define	LED2_OFF     	LATA1 = 0; LATA2 = 0
#define	LED3_ON      	LATA2 = 1; LATC0 = 0
#define	LED3_OFF     	LATA2 = 0; LATC0 = 0
#define	LED4_ON      	LATC0 = 1; LATC1 = 0
#define	LED4_OFF     	LATC0 = 0; LATC1 = 0
#define	LED5_ON      	LATC1 = 1; LATC2 = 0
#define	LED5_OFF     	LATC1 = 0; LATC2 = 0

#define	SW_UP       	RC5
#define	SW_DN       	RC4
#define	SW_FN       	RC3
#define	SW_ON           0
#define	FLG_ON          1
#define	FLG_OFF         0

#define	CHK_TFM_H       0x0A
#define	CHK_TFM_L       0x18
#define	CHK_NHK_H       0x10
#define	CHK_NHK_L       0x58

// I2C mode CHAN[9:0] BAND=2 CHAN = (Freq - 76.0M) / Ch_s
// TFM Freq=80.0 BAND=2 Ch_s=100k CHAN=40 0x28 00 0010 1000
#define	TUN_ADR         0x20
#define	TUN_I2C         0x22
#define	REG02_H         0xC0
#define	MON02_H         0xE0
#define	FUP02_H         0xC3
#define	FDN02_H         0xC1
#define	REG02_L         0x01
#define	REG03_H         0x0A
#define	REG03_L         0x18
#define	TFM03_H         0x0A
#define	TFM03_L         0x18
#define	REG04_H         0x08
#define	AFC04_H         0x09
#define	REG04_L         0x80
#define	REG05_H         0x88
#define	TUN05_H         0x8C
#define	REG05_L         0x86
#define	VUP05_L         0x8C
#define	VDN05_L         0x82

#define false           0
#define true            1

#define DOT1            50
#define DASH1           1
#define DOT0            1
#define DASH0           50
#define DARK            1


void port_init(void) {
    /* CONFIGURE GPIO */ 
    OSCCON  = 0b01101000;    //4MHz
    TRISA   = 0b00101000;    //Input(1)
    TRISC   = 0b00111000;    //Input(1)
    OPTION_REG = 0b00000000; //MSB WPUENn
    WPUA    = 0b00101000;    //PupOn(1)
    INTCON  = 0b00000000;
    LATA    = 0b00010000;
    LATC    = 0b00000000;
    ANSELA  = 0b00000000;
    ANSELC  = 0b00000000;
	ADCON0  = 0b00001001;    //CHS00010 AN2
	ADCON1  = 0b10010000;    //ADFM ADCS001 2us
	ADCON2  = 0b00000000;
}

void blk_led1(void){
    for(uint8_t lp = 0; lp < 100; lp++){
        LED1_ON;
        __delay_us(DOT1);
        LED1_OFF;
        __delay_us(DOT1);
    }    
}

void blk_led2(void){
    for(uint8_t lp = 0; lp < 100; lp++){
        LED2_ON;
        __delay_us(DOT1);
        LED2_OFF;
        __delay_us(DOT1);
    }
}

void blk_led3(void){
    for(uint8_t lp = 0; lp < 100; lp++){
        LED3_ON;
        __delay_us(DOT1);
        LED3_OFF;
        __delay_us(DOT1);
    }
}

void blk_led4(void){
    for(uint8_t lp = 0; lp < 100; lp++){
        LED4_ON;
        __delay_us(DOT1);
        LED4_OFF;
        __delay_us(DOT1);
    }
}

void blk_led5(void){
    for(uint8_t lp = 0; lp < 100; lp++){
        LED5_ON;
        __delay_us(DOT1);
        LED5_OFF;   
        __delay_us(DOT1);
    }
}

void led_chk(void){
    blk_led1();
    __delay_ms(200);

    blk_led2();
    __delay_ms(200);

    blk_led3();
    __delay_ms(200);

    blk_led4();
    __delay_ms(200);

    blk_led5();
    __delay_ms(100);
}

void i2c_snd(uint8_t data)
{
	for(uint8_t i = 0; i < 8; i++){
		if ( (data & 0x80) == 0  ){
			I2C_SDA_LOW;
		}else{
			I2C_SDA_HIGH;
		}
		
		data = (uint8_t)(data << 1) ;
		__delay_us(2);
		I2C_SCK_HIGH;
		__delay_us(4);
		I2C_SCK_LOW;
		__delay_us(2);
	}

// ACK    
	I2C_SDA_HIGH;
	__delay_us(6);
    I2C_SCK_HIGH;
    __delay_us(4);
	I2C_SCK_LOW;
	I2C_SDA_LOW;
	__delay_us(20);
}
    
uint8_t i2c_rcv_cnt()
{
	uint8_t data = 0;
    I2C_SDA_READ;
	for(uint8_t i = 0; i < 8; i++){
		data = (uint8_t)(data << 1) ;
		__delay_us(2);
		if (I2C_SDA_DATA == 1){
			data = data | 0x01;
		}
		I2C_SCK_HIGH;
		__delay_us(4);
		I2C_SCK_LOW;
		__delay_us(2);
	}

// ACK    
    __delay_us(1);
 	I2C_SDA_LOW;
    __delay_us(5);
    I2C_SCK_HIGH;
	__delay_us(4);
	I2C_SCK_LOW;
	I2C_SDA_LOW;
	__delay_us(20);

	return data;
}

uint8_t i2c_rcv_end()
{
	uint8_t data = 0;
    I2C_SDA_READ;
	for(uint8_t i = 0; i < 8; i++){
		data = (uint8_t)(data << 1) ;
		__delay_us(2);
		if (I2C_SDA_DATA == 0){
			data = data | 0x01;
		}
		I2C_SCK_HIGH;
		__delay_us(4);
		I2C_SCK_LOW;
		__delay_us(2);
	}

// NACK    
    __delay_us(1);
 	I2C_SDA_HIGH;
    __delay_us(5);
    I2C_SCK_HIGH;
    __delay_us(4);
	I2C_SCK_LOW;
	I2C_SDA_LOW;
	__delay_us(20);

	return data;
}

uint8_t tun_rcv(void)
{
	uint8_t data;
	uint8_t freq;
	uint8_t seek;
	uint8_t rssi;
// Start
	I2C_SCK_HIGH;
	I2C_SDA_HIGH;
	__delay_us(10);
	I2C_SDA_LOW;
	__delay_us(6);
	I2C_SCK_LOW;
	__delay_us(2);
// read
	data = (uint8_t)((TUN_ADR & 0xFE )| 0x01);
    i2c_snd(data);	
// reg0A
    data = i2c_rcv_cnt();	
    seek = (data & 0x40) >> 6;
// 	
    data = i2c_rcv_cnt();	
    freq = data;	
// reg0B
    data = i2c_rcv_cnt();
    rssi = data;
// 	
    data = i2c_rcv_end();	
// Stop            
	I2C_SDA_LOW;
	__delay_us(2);
	I2C_SCK_HIGH;
	__delay_us(6);	
// Wait
	I2C_SDA_HIGH;
	__delay_us(20);
	return freq;
}

void tun_chk(void)
{
	uint8_t data;
// Start
	I2C_SCK_HIGH;
	I2C_SDA_HIGH;
	__delay_us(10);
	I2C_SDA_LOW;
	__delay_us(6);
	I2C_SCK_LOW;
	__delay_us(2);
// 
	data = (uint8_t)(TUN_ADR & 0xFE );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG02_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG02_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(TFM03_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(TFM03_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG04_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG04_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG05_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG05_L & 0xFF );
    i2c_snd(data);	
// Stop            
	I2C_SDA_LOW;
	__delay_us(2);
	I2C_SCK_HIGH;
	__delay_us(6);	
// Wait
	I2C_SDA_HIGH;
	__delay_us(20);
}

uint8_t freq_set(uint8_t freq)
{
	uint8_t	frq_h;
	uint8_t	frq_l;
	frq_h = REG03_H;
	frq_h = (uint8_t)((freq - 60) >> 2);
	frq_l = (uint8_t)((((freq - 60) & 0x03) << 6) | 0x14);

	uint8_t data;
// Start
	I2C_SCK_HIGH;
	I2C_SDA_HIGH;
	__delay_us(10);
	I2C_SDA_LOW;
	__delay_us(6);
	I2C_SCK_LOW;
	__delay_us(2);
// 
	data = (uint8_t)(TUN_ADR & 0xFE );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG02_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG02_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(frq_h & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(frq_l & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG04_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG04_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG05_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG05_L & 0xFF );
    i2c_snd(data);	
// Stop            
	I2C_SDA_LOW;
	__delay_us(2);
	I2C_SCK_HIGH;
	__delay_us(6);	
// Wait
	I2C_SDA_HIGH;
	__delay_us(20);

	return frq_h;
}

uint8_t freq_up(uint8_t freq)
{
	uint8_t	frq_h;
	uint8_t	frq_l;
	frq_h = REG03_H;
	frq_h = (uint8_t)((freq - 60) >> 2);
	frq_l = (uint8_t)((((freq - 60) & 0x03) << 6) | 0x14);

	uint8_t data;
// Start
	I2C_SCK_HIGH;
	I2C_SDA_HIGH;
	__delay_us(10);
	I2C_SDA_LOW;
	__delay_us(6);
	I2C_SCK_LOW;
	__delay_us(2);
// 
	data = (uint8_t)(TUN_ADR & 0xFE );
    i2c_snd(data);	
// 
	data = (uint8_t)(FUP02_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG02_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(frq_h & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(frq_l & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG04_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG04_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(TUN05_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG05_L & 0xFF );
    i2c_snd(data);	
// Stop            
	I2C_SDA_LOW;
	__delay_us(2);
	I2C_SCK_HIGH;
	__delay_us(6);	
// Wait
	I2C_SDA_HIGH;
	__delay_us(20);

	return frq_h;
}

uint8_t freq_dn(uint8_t freq)
{
	uint8_t	frq_h;
	uint8_t	frq_l;
	frq_h = REG03_H;
	frq_h = (uint8_t)((freq - 60) >> 2);
	frq_l = (uint8_t)((((freq - 60) & 0x03) << 6) | 0x14);

	uint8_t data;
// Start
	I2C_SCK_HIGH;
	I2C_SDA_HIGH;
	__delay_us(10);
	I2C_SDA_LOW;
	__delay_us(6);
	I2C_SCK_LOW;
	__delay_us(2);
// 
	data = (uint8_t)(TUN_ADR & 0xFE );
    i2c_snd(data);	
// 
	data = (uint8_t)(FDN02_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG02_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(frq_h & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(frq_l & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG04_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG04_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(TUN05_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG05_L & 0xFF );
    i2c_snd(data);	
// Stop            
	I2C_SDA_LOW;
	__delay_us(2);
	I2C_SCK_HIGH;
	__delay_us(6);	
// Wait
	I2C_SDA_HIGH;
	__delay_us(20);

	return frq_h;
}

void vol_up(void)
{
	uint8_t data;
// Start
	I2C_SCK_HIGH;
	I2C_SDA_HIGH;
	__delay_us(10);
	I2C_SDA_LOW;
	__delay_us(6);
	I2C_SCK_LOW;
	__delay_us(2);
// 
	data = (uint8_t)(TUN_ADR & 0xFE );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG02_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG02_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(TFM03_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(TFM03_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG04_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG04_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG05_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(VUP05_L & 0xFF );
    i2c_snd(data);	
// Stop            
	I2C_SDA_LOW;
	__delay_us(2);
	I2C_SCK_HIGH;
	__delay_us(6);	
// Wait
	I2C_SDA_HIGH;
	__delay_us(20);
}

void vol_dn(void)
{
	uint8_t data;
// Start
	I2C_SCK_HIGH;
	I2C_SDA_HIGH;
	__delay_us(10);
	I2C_SDA_LOW;
	__delay_us(6);
	I2C_SCK_LOW;
	__delay_us(2);
// 
	data = (uint8_t)(TUN_ADR & 0xFE );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG02_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG02_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(TFM03_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(TFM03_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG04_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(REG04_L & 0xFF );
    i2c_snd(data);	
// 
	data = (uint8_t)(REG05_H & 0xFF );
    i2c_snd(data);	
// 	
	data = (uint8_t)(VDN05_L & 0xFF );
    i2c_snd(data);	
// Stop            
	I2C_SDA_LOW;
	__delay_us(2);
	I2C_SCK_HIGH;
	__delay_us(6);	
// Wait
	I2C_SDA_HIGH;
	__delay_us(20);
}

void led_lp(uint8_t num){
    for(uint8_t lp = 0; lp < num; lp++){
        asm ("NOP");
    }
}

void bcd_num(uint8_t num){
        uint8_t tim0[5], tim1[5];

        if(num > 15){
            blk_led1();
            return;
        }
        
        for(uint8_t lp = 0; lp < 4; lp++){
            if(num & 0x08){
                tim0[lp] = DOT0;
                tim1[lp] = DASH0;
            } else {
                tim0[lp] = DOT1;
                tim1[lp] = DASH1;
            }
            num = (uint8_t)(num << 1);
        }

        for(uint8_t lp = 0; lp < 100; lp++){
        LED2_ON;
        for(uint8_t us = 0; us < tim1[0]; us++){
            led_lp(1);
        }
        LED2_OFF;
        for(uint8_t us = 0; us < tim0[0]; us++){
            led_lp(1);
        }
        LED3_ON;
        for(uint8_t us = 0; us < tim1[1]; us++){
            led_lp(1);
        }
        LED3_OFF;
        for(uint8_t us = 0; us < tim0[1]; us++){
            led_lp(1);
        }
        LED4_ON;
        for(uint8_t us = 0; us < tim1[2]; us++){
            led_lp(1);
        }
        LED4_OFF;
        for(uint8_t us = 0; us < tim0[2]; us++){
            led_lp(1);
        }
        LED5_ON;
        for(uint8_t us = 0; us < tim1[3]; us++){
            led_lp(1);
        }
        LED5_OFF;
        for(uint8_t us = 0; us < tim0[3]; us++){
            led_lp(1);
        }
        __delay_ms(1);        
    }    
}

uint8_t frq_bcd_disp(uint8_t freq){
    uint8_t frq3 = 7;
    uint8_t frq2 = 0;
    uint8_t frq1 = 0;

    while(freq > 99){
        frq3++;
        freq = freq - 100;
    }
    if(frq3 > 9){
        frq3 = 5;
    }
    while(freq > 9){
        frq2++;
        freq = freq - 10;
    }
    if(frq2 > 9){
        frq3 = 5;
    }
    while(freq > 0){
        frq1++;
        freq = freq - 1;
    }
    if(frq1 > 9){
        frq3 = 5;
    }

    bcd_num(frq3);
    if(SW_UP == SW_ON){
        return FLG_ON;
    }
    if(SW_DN == SW_ON){
        return FLG_ON;
    }
    if(SW_FN == SW_ON){
        return FLG_ON;
    }
    __delay_ms(200);        
    bcd_num(frq2);
    if(SW_UP == SW_ON){
        return FLG_ON;
    }
    if(SW_DN == SW_ON){
        return FLG_ON;
    }
    if(SW_FN == SW_ON){
        return FLG_ON;
    }
    __delay_ms(200);        
    bcd_num(frq1);
    if(SW_UP == SW_ON){
        return FLG_ON;
    }
    if(SW_DN == SW_ON){
        return FLG_ON;
    }
    if(SW_FN == SW_ON){
        return FLG_ON;
    }
    __delay_ms(200);        
    if(SW_UP == SW_ON){
        return FLG_ON;
    }
    if(SW_DN == SW_ON){
        return FLG_ON;
    }
    if(SW_FN == SW_ON){
        return FLG_ON;
    }
    __delay_ms(200);        
    if(SW_UP == SW_ON){
        return FLG_ON;
    }
    if(SW_DN == SW_ON){
        return FLG_ON;
    }
    if(SW_FN == SW_ON){
        return FLG_ON;
    }
    __delay_ms(200);        
    return FLG_OFF;
}

void bcd_chk(void){
        frq_bcd_disp(95);
        __delay_ms(1000);        
        frq_bcd_disp(100);
        __delay_ms(1000);        
        frq_bcd_disp(230);
        __delay_ms(1000);        
}

void main(void) {

//Initialize
	port_init();

    led_chk();
    tun_chk();

    uint8_t freq = 100;
    uint8_t frq_rd = 100;
    uint8_t frq_dsp = 4;
    uint8_t frq_seq = 0;

    while(SW_FN == SW_ON){
        blk_led3();
        __delay_ms(300);        
        for(uint8_t i = 0; i < 16; i++){
            bcd_num(i);
            __delay_ms(300);        
        }
        while(SW_DN == SW_ON){
            blk_led2();
        }
        while(SW_UP == SW_ON){
            blk_led4();
        }
        __delay_ms(1000);
//        bcd_chk();
    }

    __delay_ms(500);
//Loop    
    while(1)
    {
        if(frq_dsp > 3){
// /*
            uint8_t frq_rd;
            uint8_t sw_flg;
            frq_dsp = 4;
            frq_rd = tun_rcv();
            if(frq_rd > 190){
                blk_led3();
                freq = 40;
            } else {
                freq = (frq_rd + 60);
            }
// */
            sw_flg = frq_bcd_disp(freq);
            if(sw_flg == FLG_ON){
                frq_dsp = 0;
                continue;
            }
        }

        if(SW_FN == SW_ON){
            __delay_ms(200);        
            blk_led3();
            for(uint8_t i = 0; i < 100; i++){
                if(SW_UP == SW_ON){
                    blk_led4();
//                    vol_up();
                    frq_dsp = 0;
                    break;
                }
                if(SW_DN == SW_ON){
                    blk_led2();
                    vol_dn();
                    frq_dsp = 0;
                    break;
                }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                __delay_ms(100);        
            }
            continue;
        }
        
        if(frq_seq == 0){
            if(SW_UP == SW_ON){
                __delay_ms(200);        
                blk_led3();
                freq++;
                if(freq > 250){
                    blk_led3();
                    freq = 70;
                }
                frq_dsp = 0;

                __delay_ms(200);        
                if(SW_UP != SW_ON){
                    blk_led4();
                    freq_set(freq);
                    __delay_ms(200);        
                    continue;
                }

                __delay_ms(200);        
                if(SW_UP == SW_ON){
                    blk_led4();
                    freq_up(freq);
                    frq_dsp = 0;
                    frq_seq = 1;
                    for(uint8_t lp = 0; lp < 5; lp++){
                        __delay_ms(200);        
                        blk_led5();
                    }
                    continue;
                }
            }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       

            if(SW_DN == SW_ON){
                __delay_ms(200);        
                blk_led3();
                freq--;
                if(freq < 70){
                    blk_led3();
                    freq = 250;
                }
                frq_dsp = 0;

                __delay_ms(200);        
                if(SW_DN != SW_ON){
                    blk_led4();
                    freq_set(freq);
                    continue;
                }
                __delay_ms(200);        

                if(SW_DN == SW_ON){
                    blk_led4();
                    freq_dn(freq);
                    frq_dsp = 0;
                    frq_seq = 1;
                    for(uint8_t lp = 0; lp < 5; lp++){
                        __delay_ms(200);        
                        blk_led1();
                    }
                    continue;
                }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            }
        } else {
            if(SW_UP == SW_ON){
                continue;
            }
            if(SW_DN == SW_ON){
                continue;
            }
            if(SW_FN == SW_ON){
                continue;
            }
            __delay_ms(100);        

            if(SW_UP == SW_ON){
                continue;
            }
            if(SW_DN == SW_ON){
                continue;
            }
            if(SW_FN == SW_ON){
                continue;
            }
            __delay_ms(100);        

            if(SW_UP == SW_ON){
                continue;
            }
            if(SW_DN == SW_ON){
                continue;
            }
            if(SW_FN == SW_ON){
                continue;
            }
        }
        frq_seq = 0;
        frq_dsp++;
    }
}

